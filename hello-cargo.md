% Hello, Cargo!

[Cargo](http://crates.io/) это инструмент который используют разработчики для управления своими Rust проектами. Cargo сейчас в состоянии альфы, как и Rust, и работа над ним еще продолжается. Тем не менее, он уже достаточно хорош для использования во многих Rust проектах, и поэтому предполагается, что проекты на Rust будут использовать Cargo с самого начала.

Cargo делает три вещи: собирает ваш код, скачивает нужные вашему коду зависимости и собирает их. По-началу, вашей программе не понадобятся никаких зависимостей, поэтому будем использовать только первую часть его функционала. В конце концов нам понадобится добавить несколько зависимостей. Поскольку мы начнем пользоваться Cargo, то не составит труда добавить их позже.

Если вы установили Rust с помощью официального установщика, то уже у вас установлен Cargo, иначе прочтите [как установаить cargo](https://github.com/rust-lang/cargo#installing-cargo-from-nightlies) отдельно без Rust.

## Переходим на Cargo

Давайте начнем использовать Cargo для нашей программы Hello World для сборки кода.

Чтобы Cargo-фицировать ваш проект, вы должны сделать две вещи: создать `Cargo.toml` конфигурационный файл, и поместить файл с исходным кодом в правильное место. Давайте сделаем это:

```bash
$ mkdir src
$ mv main.rs src/main.rs
```

Cargo ожидает что ваши файлы с исходным кодом находятся в директории `src`. Это оставляет верхний уровень для других вещей, вроде README, файлов с текстом лицензии и других не относящихся к вашему коду. Cargo помогает нам сохранять наши проекты красивыми и аккуратными. Всему своё место и всё на своём месте.

Дальше, наш создадим конфигурационный файл для Cargo:

```bash
$ editor Cargo.toml
```

Убедитесь, что имя правильное: вам нужна заглавная `C`!

Вставьте эту конфигурацию в свой `Cargo.toml`:

```toml
[package]

name = "hello_world"
version = "0.0.1"
authors = [ "Ваше имя <you@example.ru>" ]

[[bin]]

name = "hello_world"
```

Этот файл в формате [TOML](https://github.com/toml-lang/toml). Позволим ему самому рассказать о себе:

> TOML стремится быть минималистичным форматом для конфигурационных файлов, который легко читается благодаря понятной семантике. TOML спроектирован для однозначного отображения в хэш-таблицу. TOML должен легко преобразовываться в структуры данных широкого спектра языков программирования.

TOML очень похож на INI, но с некоторыми дополнительными возможностями.

В любом случае, в этом файле есть две *записи*: `package` и `bin`. Первая сообщает Cargo метаданные вашего пакета. Вторая сообщает Cargo что мы заинтересованы в сборке исполняемого файла, а не библиотеки (хотя мы могли сделать и то и другое!), и как его следует назвать.

Как только мы с этим закончили, мы готовы к сборке! Попробуйте собрать:

```bash
$ cargo build
   Compiling hello_world v0.0.1 (file:///home/yourname/projects/hello_world)
$ ./target/debug/hello_world
Hello, world!
```

Та-да! Мы собрали наш проект вызвав `cargo build`, и запустили его с помощью `./target/hello_world`. На первый взгляд это кажется сложнее по сравнению с более простым использованием `rustc`, но подумаем о будущем: если бы в нашем проекте было больше одного файла мы бы должны были вызвать `rustc` для каждого и передать ему кучу параметров, что бы собрать их все вместе. С Cargo когда наш проект вырастет нам понадобится вызвать только команду `cargo build` и она все сделает за нас. Когда вы закончите работать над проектом и он окончательно будет готов к релизу, то можете использовать команду `cargo build --release` для компиляции ваших крейтов с оптимизацией.

Так же вы должны были заметить что Cargo создал новый файл: `Cargo.lock`.

```toml
[root]
name = "hello_world"
version = "0.0.1"
```

Этот файл используется Cargo для отслеживания зависимостей в вашем приложении. Прямо сейчас у нас нет ни одной, поэтому этот файл довольно пуст. Вам не нужно редактировать этот файл самостоятельно, Cargo сам с ним разберется.

Так! Мы успешно собрали `hello_world` с помощью Cargo. Несмотря на то, что наша программа проста, мы использовали большую часть реальных инструментов, которые вы будете использовать в своем дальнейшем пути Rust программиста.

## Новый проект

Вам не нужно повторять вышеприведенные шаги каждый раз, когда вы хотите создать новый проект! Cargo может создать каталог проекта, в котором вы сможете приступить сразу к разработке.

Чтобы создать новый проект с помощью Cargo, нужно ввести команду `cargo new`:

```bash
$ cargo new hello_world --bin
```

Мы указываем аргумент `--bin`, т.к. хотим создать исполняемую программу. Если мы не укажем этот аргумент, то Cargo создаст проект для библиотеки.

Давайте теперь посмотрим на то, что Cargo создал нам:

```bash
$ cd hello_world
$ tree .
.
├── Cargo.toml
└── src
    └── main.rs

1 каталог, 2 файла
```

>Если у вас нет команды `tree`, то скорее всего он у вас не установлен в вашей системе. Попробуйте установить через менеджер пакетов вашего дистрибутива. Это не обязательно, но эта утилита очень полезна.

Все файлы и каталоги уже на месте. Теперь можем начинать. Для начала проверим файл `Cargo.toml`:

```toml
[package]

name = "hello_world"
version = "0.0.1"
authors = ["Ваше Имя <you@example.ru>"]
```

Cargo наполнил этот файл значениями по-умолчанию на основании переданных аргументов и глобальной конфигурауии `git`. Обратите внимаение, что Cargo уже в каталоге `hello_world` создал репозиторий для `git`.

Также заглянем в `src/main.rs`:

```rust
fn main() {
    println!("Hello, world!");
}
```

Cargo сгенерировал "Hello World!" для нас и вы можете уже приступить к программированию! Больше информации о Cargo вы можете получить [здесь](http://doc.crates.io/guide.html).

Теперь давайте отложим инструментарий и узнаем больше о самом языке Rust. Эти знания помогут постепенно погрузиться в Rust.
