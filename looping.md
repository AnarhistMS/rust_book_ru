% Циклы

Последнюю базовую конструкцию в Rust которую мы изучим это циклы. В языке Rust имеется две конструкции для создания циклов: `for` и `while`.

## Цикл `for`

Цикл `for` нужен для повторения блока кода определенного количества раз. Циклы `for` в Rust работают немного иначе, чем в других языках программирования. Например в Си подобном языке цикл `for` выглядит так:

```{c}
for (x = 0; x < 10; x++) {
    printf( "%d\n", x );
}
```

Однако, этот код в Rust будет выглядеть следующим образом:

```{rust}
for x in 0..10 {
    println!("{}", x); // x: i32
}
```

Можно показать цикл более абстрактнее:

```{ignore}
for var in выражение {
    тело_цикла
}
```

Выражение это итератор, который мы будем рассматривать позже в этом руководстве. Итератор возвращает серию элементов, где каждый элемент будет являться одной итерацией цикла. Значение этого элемента затем присваивается переменной `var`, которая будет доступна в теле цикла. После окончания тела цикла, берется следующее значение итератора и снова выполняется тело цикла. Когда в итераторе закончатся значения, то цикл `for` завершается.

В нашем примере `0..10` это выражение, где задается начальное и конечное значение, и возвращает итератор, который будет возвращать серию значений последовательно, начиная с начального значения и заканчивая конечным значением не включая его самого. В нашем примере будет напечатано от `0` до `9`, но не будет напечатано `10`.

В Rust нет цикла `for` как в Си-подобном синтаксисе, т.к. управлять каждым элементом цикла вручную сложно и приводит к ошибкам даже у опытных программистов на Си.

Мы вернемся к циклам `for` когда начнем рассматривать *итераторы*, позже в этом Руководстве.

## Цикл `while`

Цикл `while` это еще один вид конструкции цикла в Rust. Выглядит он так:

```{rust}
let mut x = 5; // mut x: u32
let mut done = false; // mut done: bool

while !done {
    x += x - 3;
    println!("{}", x);
    if x % 5 == 0 { done = true; }
}
```

этот цикл применяется, если неизвестно сколько раз нужно выполнить тело цикла, чтобы получть результат. При каждой итерации цикла проверяется условие, если оно истино, то запускается следующая итерация, иначе цикл `while` завершается.

Если вам нужен бесконечный цикл, то можете сделать условие всегда истинным:

```{rust,ignore}
while true {
```

Однако, в Rust имеется ключевое слово `loop` для такого случая:

```{rust,ignore}
loop {
```

В Rust анализатор потока управления обрабатывает конструкцию `loop` иначе, чем `while true`, хотя для нас это одно и тоже. На данном этапе изучения Rust нам не важно знать в чем именно различие между этими конструкциями, но если вы хотите сделать бесконечный цикл, то используйте конструкцию `loop`, т.к. компилятор сможет транслировать ваш код в более эффективный и безопасный машинный код.

## Управление итерацией цикла

Давайте посмотрим на цикл `while` снова:

```{rust}
let mut x = 5;
let mut done = false;

while !done {
    x += x - 3;
    println!("{}", x);
    if x % 5 == 0 { done = true; }
}
```

В этом примере имеется изменяемая переменная `done` типа boolean, которая используется в условии для выхода из цикла. В Rust имеются два ключевых слова, которые помогут нам работать с итерациями цикла: `break` и `continue`.

Можем переписать цикл более лучшим способом с помощью `break`, чтобы избавиться от переменной `done`:

```{rust}
let mut x = 5;

loop {
    x += x - 3;
    println!("{}", x);
    if x % 5 == 0 { break; }
}
```

Теперь мы исользуем бесконечный цикл `loop` и для выхода из цикла `break`.

`continue` похож на `break`, но вместо выхода из цикла переходит к следующей итерации. Следующий пример отобразит только нечетные числа:

```{rust}
for x in 0u32..10 {
    if x % 2 == 0 { continue; }

    println!("{}", x);
}
```

Использовать `continue` и `break` можно как в циклах `while`, так и в циклах `for`.
